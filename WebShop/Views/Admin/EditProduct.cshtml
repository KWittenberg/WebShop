@using WebShop.Services.Interface;
@model WebShop.Models.ViewModel.ProductViewModel
@inject IProductService productService
@{
    var categorys = await productService.GetProductCategorysAsync();
    bool disabled = false;
    bool enabled = true;
}

<!-- Edit Product -->

<br />
<div class="container mt-5" align="center">
    <div class="login-form"><h2>Edit Product</h2></div>
</div>

<form method="post" asp-action="EditProduct">
    <div class="container">
        <div class="row">
            <div class="col-lg-4">
                <div class="form-group">
                    <input asp-for="Title" type="text" class="form-control mt-4" placeholder=" Title">
                    <span asp-validation-for="Title" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="ProductCategoryId" class="control-label">&nbsp; &nbsp; Choose a category</label>
                    <select name="ProductCategoryId" class="form-select" aria-label="Default select example">
                        @foreach (var item in categorys)
                        {
                            if (item.Id == Model.ProductCategory.Id)
                            {
                                <option selected value="@item.Id">@item.Title</option>
                            }
                            else
                            {
                                <option value="@item.Id">@item.Title</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group">
                    <input asp-for="ShortDescription" type="text" class="form-control mt-3" placeholder=" Short description">
                    <span asp-validation-for="ShortDescription" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <textarea asp-for="Description" type="text" rows="7" class="form-control mt-3" placeholder=" Description"></textarea>
                    <span asp-validation-for="Description" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <input asp-for="Author" type="text" class="form-control mt-3" placeholder=" Author">
                    <span asp-validation-for="Author" class="text-danger"></span>
                </div>
                <fieldset name="Available" @Model.Available>
                    <legend>
                        <label><input type=checkbox name="Available" value="@Model.Available" onchange="form.Available.disabled = !checked">Available</label>
                    </legend>
                    <div class="form-group">
                        <input asp-for="Quantity" type="text" class="form-control mt-3" placeholder=" Quantity">
                        <span asp-validation-for="Quantity" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        @*<input type="number" step="any" name="Price" class="form-control" value="@Model.Price.ToString().Replace(",",".")" />*@
                        <input asp-for="Price" type="text" class="form-control mt-3" placeholder=" Price">
                        <span asp-validation-for="Price" class="text-danger"></span>
                    </div>
                    <fieldset name="Discount" @Model.Discount>
                        <legend>
                            <label><input type=checkbox name="Discount" value="@Model.Discount" onchange="form.discount.disabled = !checked">Discount</label>
                        </legend>
                        <div class="form-group">
                            <input asp-for="DiscountPrice" type="text" class="form-control mt-3" placeholder=" Discount price">
                            <span asp-validation-for="DiscountPrice" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <input asp-for="StartDate" type="date" class="form-control mt-3" placeholder=" StartDate">
                            <span asp-validation-for="StartDate" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <input asp-for="EndDate" type="date" class="form-control mt-3" placeholder=" EndDate">
                            <span asp-validation-for="EndDate" class="text-danger"></span>
                        </div>
                    </fieldset>
                </fieldset>
            </div>
            <div class="col-lg-4">
                <div class="contact-form">
                    <div class="form-group">
                        <input asp-for="Image" type="text" class="form-control mt-4" placeholder=" Image">
                    </div>
                    <div class="form-group text-center">
                        <img id="ImagePreview" class="border-info rounded mt-4" style="max-width: 350px" />
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="contact-form">
                    <div class="form-group">
                        <input asp-for="YearOfPublication" type="text" class="form-control mt-4" placeholder=" Year of publication">
                        <span asp-validation-for="YearOfPublication" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <input asp-for="Publisher" type="text" class="form-control mt-3" placeholder=" Publisher">
                        <span asp-validation-for="Publisher" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <input asp-for="Isbn" type="text" class="form-control mt-3" placeholder=" ISBN">
                        <span asp-validation-for="Isbn" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <select asp-for="BookCategory" class="form-control mt-3" asp-items="Html.GetEnumSelectList<BookCategory>()"></select>
                        <span asp-validation-for="BookCategory" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <select asp-for="BookBinding" class="form-control mt-3" asp-items="Html.GetEnumSelectList<BookBinding>()"></select>
                        <span asp-validation-for="BookBinding" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <input asp-for="NumberOfPages" type="text" class="form-control mt-3" placeholder=" Number of pages">
                        <span asp-validation-for="NumberOfPages" class="text-danger"></span>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <div class="form-group">
                                <input asp-for="Width" type="text" class="form-control mt-3" placeholder=" Width">
                                <span asp-validation-for="Width" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="form-group">
                                <input asp-for="Height" type="text" class="form-control mt-3" placeholder=" Height">
                                <span asp-validation-for="Height" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="form-group">
                                <input asp-for="Thickness" type="text" class="form-control mt-3" placeholder=" Thickness">
                                <span asp-validation-for="Thickness" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <input asp-for="Weight" type="text" class="form-control mt-3" placeholder=" Weight">
                        <span asp-validation-for="Weight" class="text-danger"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container" align="right">
        <button type="submit" class="mt-3 mb-5 primary-btn">Update</button><a asp-controller="Admin" asp-action="ProductAdministration" class="mt-3 mb-5 secondary-btn">Back</a>
    </div>
</form>

@section Scripts{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            var output = document.getElementById('ImagePreview');
            output.src = $("#Image").val();
        })

        $("#Image").on("change", function () {
            var output = document.getElementById('ImagePreview');
            output.src = $(this).val();
        })
    </script>

    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    }